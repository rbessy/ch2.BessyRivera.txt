-- Chapter 9, Hands-on #1

Assigment 1.
SELECT b.title, p.contact, p.phone
	FROM books b, publisher p
	WHERE b.pubid = p.pubid;
Output.
TITLE	CONTACT	PHONE
BODYBUILD IN 10 MINUTES A DAY	RENEE SMITH	800-555-9743
REVENGE OF MICKEY	TOMMIE SEYMOUR	000-714-8321
BUILDING A CAR WITH TOOTHPICKS	JANE TOMLIN	010-410-0010
DATABASE IMPLEMENTATION	DAVID DAVIDSON	800-555-1211
COOKING WITH MUSHROOMS	RENEE SMITH	800-555-9743
HOLY GRAIL OF ORACLE	DAVID DAVIDSON	800-555-1211
HANDCRANKED COMPUTERS	DAVID DAVIDSON	800-555-1211
E-BUSINESS THE EASY WAY	JANE TOMLIN	010-410-0010
PAINLESS CHILD-REARING	SEBASTIAN JONES	800-555-8284
THE WOK WAY TO COOK	RENEE SMITH	800-555-9743
BIG BEAR AND LITTLE DOVE	SEBASTIAN JONES	800-555-8284
HOW TO GET FASTER PIZZA	RENEE SMITH	800-555-9743
HOW TO MANAGE THE MANAGER	TOMMIE SEYMOUR	000-714-8321
SHORTEST POEMS	SEBASTIAN JONES	800-555-8284

SELECT b.title, p.contact, p.phone
	FROM books b JOIN publisher p
	USING (pubid);
Output.
TITLE	CONTACT	PHONE
BODYBUILD IN 10 MINUTES A DAY	RENEE SMITH	800-555-9743
REVENGE OF MICKEY	TOMMIE SEYMOUR	000-714-8321
BUILDING A CAR WITH TOOTHPICKS	JANE TOMLIN	010-410-0010
DATABASE IMPLEMENTATION	DAVID DAVIDSON	800-555-1211
COOKING WITH MUSHROOMS	RENEE SMITH	800-555-9743
HOLY GRAIL OF ORACLE	DAVID DAVIDSON	800-555-1211
HANDCRANKED COMPUTERS	DAVID DAVIDSON	800-555-1211
E-BUSINESS THE EASY WAY	JANE TOMLIN	010-410-0010
PAINLESS CHILD-REARING	SEBASTIAN JONES	800-555-8284
THE WOK WAY TO COOK	RENEE SMITH	800-555-9743
BIG BEAR AND LITTLE DOVE	SEBASTIAN JONES	800-555-8284
HOW TO GET FASTER PIZZA	RENEE SMITH	800-555-9743
HOW TO MANAGE THE MANAGER	TOMMIE SEYMOUR	000-714-8321
SHORTEST POEMS	SEBASTIAN JONES	800-555-8284

Assigment 2.
SELECT c.firstname, c.lastname, o.order#
	FROM customers c, orders o
	WHERE c.customer# = o.customer#
	AND o.shipdate IS NULL
	ORDER BY o.orderdate;
Output.
FIRSTNAME	LASTNAME	ORDER#
BECCA	NELSON	1012
LEILA	SMITH	1016
KENNETH	FALAH	1015
GREG	MONTIASA	1019
BONITA	MORALES	1018
KENNETH	JONES	1020

SELECT c.firstname, c.lastname, o.order#
	FROM customers c JOIN orders o
	USING (customer#)
	WHERE o.shipdate IS NULL
	ORDER BY o.orderdate;
Output.
FIRSTNAME	LASTNAME	ORDER#
BECCA	NELSON	1012
LEILA	SMITH	1016
KENNETH	FALAH	1015
GREG	MONTIASA	1019
BONITA	MORALES	1018
KENNETH	JONES	1020

Assigment 3.
SELECT DISTINCT c.lastname, c.customer#
	FROM books b, orders o, orderitems i, customers c
	WHERE c.customer# = o.customer#
	AND o.order# = i.order#
	AND i.isbn = b.isbn
	AND c.state = 'FL'
	AND b.category = 'COMPUTER';
Output.
LASTNAME	CUSTOMER#
SMITH	1003
MORALES	1001

SELECT DISTINCT c.lastname, customer#
	FROM books b JOIN orderitems USING (isbn)
	JOIN orders USING (order#)
	JOIN customers c USING (customer#)
	WHERE c.state = 'FL'
	AND b.category = 'COMPUTER';
Output.
LASTNAME	CUSTOMER#
SMITH	1003
MORALES	1001

Assigment 4.
SELECT DISTINCT b.title
	FROM customers c, orders o, orderitems i, books b
	WHERE c.customer# = o.customer#
	AND o.order# = i.order#
	AND i.isbn = b.isbn
	AND c.firstname = 'JAKE'
	AND c.lastname = 'LUCAS';
Output.
TITLE
HOW TO MANAGE THE MANAGER
PAINLESS CHILD-REARING

SELECT DISTINCT b.title
	FROM customers c JOIN orders USING (customer#)
	JOIN orderitems USING (order#)
	JOIN books b USING (isbn)
	WHERE c.firstname = 'JAKE'
	AND c.lastname = 'LUCAS';
Output.
TITLE
HOW TO MANAGE THE MANAGER
PAINLESS CHILD-REARING

Assigment 5.
SELECT b.title, i.paideach-cost
	FROM customers c, orders o, orderitems i, books b
	WHERE c.customer# = o.customer#
	AND o.order# = i.order#
	AND i.isbn = b.isbn
	AND c.firstname = 'JAKE'
	AND c.lastname = 'LUCAS'
	ORDER BY o.orderdate, i.paideach-b.cost DESC;
Output.
TITLE	I.PAIDEACH-COST
PAINLESS CHILD-REARING	37.45
HOW TO MANAGE THE MANAGER	16.55
PAINLESS CHILD-REARING	37.45

SELECT b.title, i.paideach-b.cost
	FROM customers c JOIN orders o USING (customer#)
	JOIN orderitems i USING (order#)
	JOIN books b USING (isbn)
	WHERE c.firstname = 'JAKE'
	AND c.lastname = 'LUCAS'
	ORDER BY o.orderdate, i.paideach-b.cost DESC;
Output.
TITLE	I.PAIDEACH-B.COST
PAINLESS CHILD-REARING	37.45
HOW TO MANAGE THE MANAGER	16.55
PAINLESS CHILD-REARING	37.45

Assigment 6.
SELECT b.title
	FROM books b, bookauthor ba, author a
	WHERE b.isbn = ba.isbn
	AND ba.authorid = a.authorid
	AND a.lname = 'ADAMS';
Output.
TITLE
DATABASE IMPLEMENTATION

SELECT b.title
	FROM books b JOIN bookauthor USING (isbn)
	JOIN author a USING (authorid)
	WHERE a.lname = 'ADAMS';
Output.
TITLE
DATABASE IMPLEMENTATION

Assigment 7.
SELECT p.gift
	FROM books b, promotion p
	WHERE b.retail BETWEEN p.minretail AND p.maxretail
	AND b.title = 'SHORTEST POEMS';
Output.
GIFT
BOOK COVER

SELECT p.gift
	FROM books b JOIN promotion p
	ON b.retail BETWEEN p.minretail AND p.maxretail
	WHERE b.title = 'SHORTEST POEMS';
Outpuit.
GIFT
BOOK COVER

Assigment 8.
SELECT a.lname, a.fname, b.title
	FROM books b, orders o, orderitems i, customers c, bookauthor t, author a
	WHERE c.customer# = o.customer#
	AND o.order# = i.order#
	AND i.isbn = b.isbn
	AND b.isbn = t.isbn
	AND t.authorid = a.authorid
	AND c.firstname = 'BECCA'
	AND c.lastname = 'NELSON';
Output.
LNAME	FNAME	TITLE
JONES	JANICE	REVENGE OF MICKEY
BAKER	JACK	PAINLESS CHILD-REARING
WHITE	WILLIAM	HANDCRANKED COMPUTERS
WHITE	LISA	HANDCRANKED COMPUTERS
ROBINSON	ROBERT	PAINLESS CHILD-REARING
ROBINSON	ROBERT	BIG BEAR AND LITTLE DOVE
FIELDS	OSCAR	PAINLESS CHILD-REARING

SELECT a.lname, a.fname, b.title
	FROM customers c JOIN orders USING (customer#)
	JOIN orderitems USING (order#)
	JOIN books b USING (isbn)
	JOIN bookauthor USING (isbn)
	JOIN author a USING (authorid)
	WHERE c.firstname = 'BECCA'
	AND c.lastname = 'NELSON';
Output.
LNAME	FNAME	TITLE
JONES	JANICE	REVENGE OF MICKEY
BAKER	JACK	PAINLESS CHILD-REARING
WHITE	WILLIAM	HANDCRANKED COMPUTERS
WHITE	LISA	HANDCRANKED COMPUTERS
ROBINSON	ROBERT	PAINLESS CHILD-REARING
ROBINSON	ROBERT	BIG BEAR AND LITTLE DOVE
FIELDS	OSCAR	PAINLESS CHILD-REARING

Assigment 9.
SELECT b.title, o.order#, c.state
	FROM books b, orders o, orderitems i, customers c
	WHERE c.customer# (+) = o.customer#
	AND o.order# (+) = i.order#
	AND i.isbn (+) = b.isbn;
Output.
TITLE	ORDER#	STATE
DATABASE IMPLEMENTATION	1003	FL
BODYBUILD IN 10 MINUTES A DAY	1003	FL
COOKING WITH MUSHROOMS	1003	FL
COOKING WITH MUSHROOMS	1018	FL
DATABASE IMPLEMENTATION	1018	FL
E-BUSINESS THE EASY WAY	1006	FL
PAINLESS CHILD-REARING	1016	FL
COOKING WITH MUSHROOMS	1008	ID
COOKING WITH MUSHROOMS	1000	WA
COOKING WITH MUSHROOMS	1009	WA
REVENGE OF MICKEY	1009	WA
HOLY GRAIL OF ORACLE	1007	TX
E-BUSINESS THE EASY WAY	1007	TX
BIG BEAR AND LITTLE DOVE	1007	TX
DATABASE IMPLEMENTATION	1007	TX
REVENGE OF MICKEY	1014	TX
COOKING WITH MUSHROOMS	1020	WY
HOW TO MANAGE THE MANAGER	1001	GA
PAINLESS CHILD-REARING	1001	GA
PAINLESS CHILD-REARING	1011	GA
DATABASE IMPLEMENTATION	1002	IL
DATABASE IMPLEMENTATION	1013	WY
BIG BEAR AND LITTLE DOVE	1017	FL
BIG BEAR AND LITTLE DOVE	1012	MI
HANDCRANKED COMPUTERS	1012	MI
PAINLESS CHILD-REARING	1012	MI
REVENGE OF MICKEY	1012	MI
SHORTEST POEMS	1005	GA
REVENGE OF MICKEY	1019	GA
DATABASE IMPLEMENTATION	1010	NJ
PAINLESS CHILD-REARING	1004	NJ
COOKING WITH MUSHROOMS	1015	NJ
BUILDING A CAR WITH TOOTHPICKS	 - 	 - 
THE WOK WAY TO COOK	 - 	 - 
HOW TO GET FASTER PIZZA	 - 	 - 

SELECT b.title, order#, c.state
	FROM books b LEFT OUTER JOIN orderitems i USING (isbn)
	LEFT OUTER JOIN orders USING (order#)
	LEFT OUTER JOIN customers c USING (customer#);
output.
TITLE	ORDER#	STATE
DATABASE IMPLEMENTATION	1003	FL
BODYBUILD IN 10 MINUTES A DAY	1003	FL
COOKING WITH MUSHROOMS	1003	FL
COOKING WITH MUSHROOMS	1018	FL
DATABASE IMPLEMENTATION	1018	FL
E-BUSINESS THE EASY WAY	1006	FL
PAINLESS CHILD-REARING	1016	FL
COOKING WITH MUSHROOMS	1008	ID
COOKING WITH MUSHROOMS	1000	WA
COOKING WITH MUSHROOMS	1009	WA
REVENGE OF MICKEY	1009	WA
HOLY GRAIL OF ORACLE	1007	TX
E-BUSINESS THE EASY WAY	1007	TX
BIG BEAR AND LITTLE DOVE	1007	TX
DATABASE IMPLEMENTATION	1007	TX
REVENGE OF MICKEY	1014	TX
COOKING WITH MUSHROOMS	1020	WY
HOW TO MANAGE THE MANAGER	1001	GA
PAINLESS CHILD-REARING	1001	GA
PAINLESS CHILD-REARING	1011	GA
DATABASE IMPLEMENTATION	1002	IL
DATABASE IMPLEMENTATION	1013	WY
BIG BEAR AND LITTLE DOVE	1017	FL
BIG BEAR AND LITTLE DOVE	1012	MI
HANDCRANKED COMPUTERS	1012	MI
PAINLESS CHILD-REARING	1012	MI
REVENGE OF MICKEY	1012	MI
SHORTEST POEMS	1005	GA
REVENGE OF MICKEY	1019	GA
DATABASE IMPLEMENTATION	1010	NJ
PAINLESS CHILD-REARING	1004	NJ
COOKING WITH MUSHROOMS	1015	NJ
BUILDING A CAR WITH TOOTHPICKS	 - 	 - 
THE WOK WAY TO COOK	 - 	 - 
HOW TO GET FASTER PIZZA	 - 	 - 

Assigment 10.
SELECT e.fname || ' ' || e.lname "Employee Name", e.job,
	m.fname || ' ' || m.lname "Manager Name"
	FROM employees e, employees m
	WHERE e.mgr = m.empno (+)
	ORDER BY "Manager Name";
Output.
Employee Name	JOB	Manager Name
BEN KING	GTECH2	 
SAM SMITH	GTech1	BEN KING
LARRY JONES	MTech2	BEN KING
JIM POTTS	GTech1	BEN KING
SUE STUART	MTech1	LARRY JONES

SELECT e.fname || ' ' || e.lname "Employee Name", e.job, m.fname || ' ' || m.lname "Manager Name"
	FROM employees e LEFT OUTER JOIN employees m
	ON e.mgr = m.empno
	ORDER BY "Manager Name";
Output.
Employee Name	JOB	Manager Name
BEN KING	GTECH2	 
SAM SMITH	GTech1	BEN KING
LARRY JONES	MTech2	BEN KING
JIM POTTS	GTech1	BEN KING
SUE STUART	MTech1	LARRY JONES

-- Chapter 9, Advanced challenge #1
1.
SELECT b.title, pu.name, b.retail-b.cost, p.gift
	FROM books b JOIN publisher pu USING (pubid)
 	JOIN promotion p ON b.retail BETWEEN p.minretail AND p.maxretail
	ORDER BY b.retail-b.cost;
Output.
TITLE	NAME	B.RETAIL-B.COST	GIFT
HANDCRANKED COMPUTERS	AMERICAN PUBLISHING	3.2	BOOK LABELS
BIG BEAR AND LITTLE DOVE	REED-N-RITE	3.63	BOOKMARKER
COOKING WITH MUSHROOMS	READING MATERIALS INC.	7.45	BOOK LABELS
REVENGE OF MICKEY	PRINTING IS US	7.8	BOOK LABELS
THE WOK WAY TO COOK	READING MATERIALS INC.	9.75	BOOK COVER
HOW TO GET FASTER PIZZA	READING MATERIALS INC.	12.1	BOOK COVER
BODYBUILD IN 10 MINUTES A DAY	READING MATERIALS INC.	12.2	BOOK COVER
HOW TO MANAGE THE MANAGER	PRINTING IS US	16.55	BOOK COVER
E-BUSINESS THE EASY WAY	PUBLISH OUR WAY	16.6	BOOK COVER
SHORTEST POEMS	REED-N-RITE	18.1	BOOK COVER
BUILDING A CAR WITH TOOTHPICKS	PUBLISH OUR WAY	22.15	FREE SHIPPING
DATABASE IMPLEMENTATION	AMERICAN PUBLISHING	24.55	BOOK COVER
HOLY GRAIL OF ORACLE	AMERICAN PUBLISHING	28.7	FREE SHIPPING
PAINLESS CHILD-REARING	REED-N-RITE	41.95	FREE SHIPPING

2.
SELECT isbn
	FROM books
	MINUS
	SELECT isbn
	FROM orderitems;
Output.
ISBN
0132149871
0299282519
4981341710
